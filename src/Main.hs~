import Graphics.UI.GLUT
import Data.IORef
import Bindings
import Life

grid :: Grid
grid = text2grid ["--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"----------------------------@---------------------"
,"--------------------------@-@---------------------"
,"----------------@@------@@------------@@----------"
,"---------------@---@----@@------------@@----------"
,"----@@--------@-----@---@@------------------------"
,"----@@--------@---@-@@----@-@---------------------"
,"--------------@-----@-------@---------------------"
,"---------------@---@------------------------------"
,"----------------@@--------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"
                 ,"--------------------------------------------------"]

main :: IO ()
main = do
  print grid
  (_progname, _args) <- getArgsAndInitialize
  initialDisplayMode $= [DoubleBuffered]
  _window <- createWindow "Conway's Game of Life"
  reshapeCallback $= Just reshape
  keyboardMouseCallback $= Just keyboardMouse
  gridRef <- newIORef grid
  displayCallback $= display gridRef
  idleCallback $= Just (idle gridRef)
  mainLoop
